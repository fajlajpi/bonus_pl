{% extends "base.html" %}
{% block title %}Sales Rep Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">
  <h2>Sales Rep Dashboard</h2>
  <p>Welcome, {{ user.first_name }} {{ user.last_name }}.</p>

  <!-- Regions -->
  <div class="dashboard-section">
    <h3>Your Regions</h3>
    <ul>
      {% for region in regions %}
        <li><strong>{{ region.name }}</strong> ({{ region.code }})</li>
      {% empty %}
        <li>No regions assigned.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Summary Stats -->
  <div class="dashboard-section">
    <h3>Overview</h3>
    <div class="summary-stats">
      <div class="stat-card">
        <span class="stat-value">{{ total_clients }}</span>
        <span class="stat-label">Total Clients</span>
      </div>
      <div class="stat-card">
        <span class="stat-value">{{ clients_with_contracts }}</span>
        <span class="stat-label">With Active Contracts</span>
      </div>
      <div class="stat-card">
        <span class="stat-value">{{ total_confirmed_points }}</span>
        <span class="stat-label">Total Confirmed Points</span>
      </div>
      <div class="stat-card">
        <span class="stat-value">{{ pending_requests }}</span>
        <span class="stat-label">Pending Reward Requests</span>
      </div>
    </div>
  </div>

  <!-- Quick Links -->
  <div class="dashboard-section">
    <h3>Quick Links</h3>
    <div class="dashboard-actions">
      <a href="{% url 'salesrep_clients' %}" class="dashboard-button">
        <span class="button-icon">üë•</span>
        <span class="button-text">My Clients</span>
      </a>
      <a href="{% url 'salesrep_reward_requests' %}" class="dashboard-button">
        <span class="button-icon">üéÅ</span>
        <span class="button-text">Reward Requests</span>
      </a>
    </div>
  </div>

  <!-- Top Clients by Points -->
  {% if top_clients %}
  <div class="dashboard-section">
    <h3>Top Clients by Available Points</h3>
    <div class="table-container">
      <table class="transactions-table">
        <thead>
          <tr>
            <th>Client</th>
            <th>Customer Number</th>
            <th>Region</th>
            <th>Available Points</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for client in top_clients %}
          <tr>
            <td>{{ client.first_name }} {{ client.last_name }}</td>
            <td>{{ client.user_number }}</td>
            <td>{{ client.region.name|default:"‚Äî" }}</td>
            <td class="value positive">{{ client.available_points }}</td>
            <td>
              <a href="{% url 'salesrep_client_detail' client.pk %}" class="details-link">View</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
